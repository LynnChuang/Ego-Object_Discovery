
%% Parameters

%%%%%% Errors using HALF of the CLASSES
obj_errors_cell = {     [0.1664  0.0998  0.0668  0.1667  0.1001  0.1331; 0.0666  0.0668  0.0998  0.1997  0.0671  0.0671; 0.1001  0.0666  0.0666  0.0000  0.0666  0.0666; 0.0666  0.0000  0.0930  0.0688  0.1154  0.1054; 0.0773  0.1631  0.0761  0.0952  0.0686  0.0548; 0.0954  0.0956  0.0707  0.0818  0.0999  0.1348];
    [0.1334  0.0668  0.2330  0.0999  0.1667  0.0333; 0.0333  0.0000  0.1667  0.0999  0.1667  0.1334; 0.0334  0.1337  0.0001  0.0667  0.0998  0.1667; 0.0337  0.1612  0.0400  0.0272  0.0563  0.0442; 0.1464  0.1623  0.0521  0.1124  0.0442  0.0814; 0.1242  0.1716  0.1880  0.0794  0.1956  0.0993];
    [0.1001  0.0666  0.0999  0.0999  0.1002  0.1334; 0.0666  0.1668  0.1334  0.0666  0.0668  0.1332; 0.1332  0.0000  0.1334  0.0333  0.0666  0.1668; 0.1000  0.0999  0.0742  0.0458  0.0432  0.1054; 0.0731  0.1289  0.0920  0.1662  0.1585  0.0675; 0.1248  0.0938  0.1190  0.0986  0.1155  0.1619];
    [0.0336  0.0336  0.0666  0.1331  0.0666  0.1670; 0.0998  0.0666  0.0666  0.0333  0.1331  0.2002; 0.0668  0.1000  0.0666  0.0666  0.0333  0.0333; 0.0679  0.1002  0.0130  0.0248  0.0157  0.0370; 0.1027  0.1446  0.1007  0.0695  0.1643  0.0784; 0.0892  0.1261  0.0684  0.0519  0.1401  0.1040];
    [0.0666  0.0333  0.2666  0.1333  0.2000  0.0666; 0.1000  0.0667  0.1667  0.1333  0.1001  0.1668; 0.0999  0.1334  0.0335  0.0334  0.1000  0.1332; 0.1336  0.1332  0.0645  0.0343  0.0480  0.0679; 0.1913  0.1506  0.1210  0.1464  0.1344  0.1171; 0.1419  0.0945  0.1549  0.1093  0.1687  0.0899]
};

noobj_errors_cell = {   [0.4601  0.4761  0.3572  0.3333  0.3493  0.4681; 0.4841  0.3572  0.4761  0.4522  0.2304  0.2304; 0.3492  0.4840  0.4840  0.4998  0.4841  0.4838; 0.4840  0.4999  0.3517  0.4873  0.4680  0.4841; 0.4645  0.4625  0.4538  0.4686  0.4741  0.4680; 0.4785  0.4601  0.4916  0.4549  0.4689  0.4562];
    [0.3413  0.3572  0.4444  0.4762  0.3333  0.4921; 0.4921  0.5000  0.3333  0.4762  0.3333  0.3413; 0.4920  0.2143  0.5000  0.4840  0.4761  0.3334; 0.4920  0.2080  0.4977  0.4953  0.4974  0.4954; 0.4257  0.4508  0.4809  0.4618  0.4705  0.4583; 0.4472  0.4346  0.4123  0.4758  0.4393  0.4697];
    [0.3491  0.4842  0.4763  0.4763  0.2220  0.3412; 0.4842  0.2062  0.3412  0.4842  0.3570  0.4684; 0.4684  0.5000  0.3412  0.4920  0.4840  0.2065; 0.3498  0.4733  0.4874  0.4909  0.3677  0.4795; 0.4718  0.4454  0.4816  0.4558  0.4576  0.4708; 0.4140  0.3668  0.4176  0.4390  0.4686  0.4522];
    [0.3649  0.3649  0.4842  0.4685  0.4842  0.2061; 0.4763  0.4842  0.4842  0.4921  0.4685  0.1982; 0.3570  0.3494  0.4842  0.4842  0.4921  0.4921; 0.4841  0.4762  0.4992  0.4977  0.4994  0.4963; 0.4446  0.4552  0.4575  0.4877  0.4553  0.4657; 0.4046  0.4000  0.4413  0.4552  0.4682  0.4581];
    [0.4839  0.4920  0.3092  0.3414  0.3253  0.4839; 0.4759  0.3574  0.3333  0.3414  0.2229  0.0803; 0.4759  0.2151  0.4920  0.3655  0.3495  0.3414; 0.4681  0.4680  0.4872  0.4979  0.4929  0.4832; 0.4314  0.4446  0.4701  0.4488  0.4566  0.4627; 0.3931  0.4339  0.4317  0.4215  0.4356  0.4580]
};

%%%%%% Errors using ALL CLASSES
% obj_errors_cell = {  [0.1251  0.0752  0.2753  0.2253  0.3252  0.3252; 0.1246  0.1498  0.3002  0.3002  0.2253  0.3002; 0.0999  0.0999  0.0999  0.0999  0.0999  0.0999; 0.1987  0.1987  0.3255  0.3255  0.3255  0.3255; 0.0999  0.0859  0.0595  0.0617  0.0713  0.0713; 0.0898  0.0898  0.0853  0.0965  0.0707  0.0612];
%                 [0.0000  0.0000  0.2010  0.1761  0.2010  0.1761; 0.0000  0.0000  0.1013  0.1013  0.1761  0.2010; 0.4003  0.4003  0.4496  0.4003  0.4003  0.4250; 0.4003  0.4003  0.4113  0.4115  0.4118  0.4118; 0.0997  0.0896  0.0599  0.0571  0.0624  0.0627; 0.0941  0.0941  0.0873  0.0997  0.0683  0.0588];
%                 [0.0000  0.0000  0.1523  0.1242  0.1242  0.1507; 0.0265  0.0000  0.1507  0.1490  0.1507  0.0993; 0.4007  0.4007  0.4007  0.4007  0.4007  0.4007; 0.3985  0.3985  0.3295  0.3292  0.3297  0.3295; 0.0933  0.0773  0.0579  0.0640  0.0712  0.0712; 0.0944  0.0944  0.0889  0.0905  0.0662  0.0657];
%                 [0.0000  0.0000  0.0747  0.0747  0.0996  0.1244; 0.0249  0.0249  0.0996  0.0498  0.0498  0.0747; 0.4004  0.4004  0.4004  0.4004  0.4004  0.4004; 0.4004  0.4004  0.3670  0.3673  0.3670  0.3673; 0.1023  0.0868  0.0608  0.0625  0.0697  0.0697; 0.0874  0.0874  0.0957  0.1007  0.0708  0.0625];
%                 [0.0499  0.0499  0.2753  0.2753  0.2253  0.2500; 0.0749  0.0499  0.3002  0.2753  0.2753  0.3252; 0.0999  0.0999  0.0999  0.0999  0.0999  0.0999; 0.0999  0.0999  0.0847  0.0850  0.0853  0.0853; 0.0960  0.0758  0.0533  0.0544  0.0634  0.0634; 0.0825  0.0825  0.0948  0.0971  0.0600  0.0561];
%                 [0.0000  0.0497  0.1243  0.0746  0.0994  0.0994; 0.0249  0.0249  0.0994  0.0746  0.0994  0.0994; 0.4006  0.4006  0.4251  0.4251  0.4006  0.4989; 0.4453  0.4453  0.3768  0.3768  0.3765  0.3768; 0.0989  0.0917  0.0619  0.0691  0.0807  0.0807; 0.0878  0.0878  0.0878  0.0989  0.0707  0.0680];
%                 [0.0249  0.0000  0.2001  0.1757  0.1752  0.1502; 0.0000  0.0000  0.2506  0.1757  0.2007  0.2007; 0.0000  0.0000  0.1258  0.2007  0.2001  0.2256; 0.3963  0.3963  0.4049  0.4052  0.4052  0.4049; 0.0926  0.0837  0.0560  0.0588  0.0665  0.0665; 0.0771  0.0771  0.0826  0.0915  0.0649  0.0593];
%                 [0.4937  0.5000  0.2625  0.0813  0.2688  0.2750; 0.5000  0.5000  0.0625  0.0813  0.0750  0.0750; 0.4994  0.4994  0.0938  0.0750  0.2622  0.0688; 0.3766  0.3766  0.0081  0.0081  0.0081  0.0080; 0.1326  0.0988  0.0842  0.0781  0.0789  0.0789; 0.2023  0.2023  0.1876  0.1306  0.0928  0.0846];
%                 [0.0742  0.1237  0.0495  0.0990  0.0742  0.1485; 0.0990  0.0990  0.1485  0.1237  0.1237  0.0990; 0.4297  0.4255  0.4499  0.4499  0.4499  0.4499; 0.4494  0.4494  0.4193  0.4196  0.4193  0.4190; 0.0951  0.0793  0.0568  0.0591  0.0658  0.0658; 0.0939  0.0939  0.0866  0.0906  0.0647  0.0585];
%                 [0.0000  0.0495  0.1782  0.1782  0.1535  0.1782; 0.0000  0.0000  0.2277  0.1782  0.1782  0.1287; 0.1040  0.1323  0.3515  0.3267  0.3515  0.3020; 0.4499  0.4499  0.4070  0.4070  0.4079  0.4068; 0.0919  0.0798  0.0605  0.0633  0.0759  0.0759; 0.0798  0.0798  0.0842  0.0935  0.0693  0.0682]
% };
%             
% noobj_errors_cell ={ [0.2808  0.2932  0.0555  0.0678  0.0432  0.0432; 0.2808  0.2745  0.0493  0.0493  0.0678  0.0493; 0.4752  0.4752  0.4752  0.4752  0.4752  0.4752; 0.4323  0.4323  0.0291  0.0291  0.0291  0.0291; 0.1147  0.0941  0.0855  0.0790  0.0763  0.0762; 0.1633  0.1633  0.1699  0.1117  0.0907  0.0822];
%                 [0.5000  0.5000  0.0740  0.0802  0.0740  0.0802; 0.5000  0.5000  0.0987  0.0987  0.0802  0.0740; 0.0245  0.0245  0.0123  0.0245  0.0245  0.0184; 0.0245  0.0245  0.0068  0.0068  0.0068  0.0068; 0.1146  0.0937  0.0818  0.0783  0.0773  0.0773; 0.1523  0.1523  0.1675  0.1099  0.0916  0.0830];
%                 [0.5000  0.5000  0.0876  0.4687  0.4687  0.2750; 0.3063  0.5000  0.2750  0.4624  0.2750  0.4750; 0.0250  0.0250  0.0250  0.0250  0.0250  0.0250; 0.0256  0.0256  0.0316  0.0316  0.0316  0.0316; 0.1174  0.1003  0.0838  0.0790  0.0815  0.0815; 0.1436  0.1436  0.1494  0.1180  0.0968  0.0830];
%                 [0.5000  0.5000  0.4812  0.4812  0.4750  0.4687; 0.4937  0.4937  0.4750  0.4875  0.4875  0.4812; 0.0250  0.0250  0.0250  0.0250  0.0250  0.0250; 0.0250  0.0250  0.0170  0.0168  0.0170  0.0169; 0.1164  0.0948  0.0851  0.0779  0.0795  0.0795; 0.1751  0.1751  0.1556  0.1161  0.0943  0.0847];
%                 [0.4877  0.4877  0.0555  0.0555  0.0678  0.2500; 0.4815  0.4877  0.0493  0.0555  0.0555  0.0432; 0.4748  0.4748  0.4748  0.4748  0.4748  0.4748; 0.4737  0.4737  0.4465  0.4465  0.4466  0.4465; 0.1268  0.1000  0.0900  0.0815  0.0851  0.0851; 0.2066  0.2066  0.1690  0.1249  0.1008  0.0867];
%                 [0.5000  0.4875  0.4687  0.4812  0.4750  0.4750; 0.4937  0.4937  0.4750  0.4812  0.4750  0.4750; 0.0250  0.0250  0.0188  0.0188  0.0250  0.0000; 0.0125  0.0125  0.0172  0.0172  0.0172  0.0173; 0.1196  0.0922  0.0829  0.0797  0.0825  0.0826; 0.1713  0.1713  0.1695  0.1189  0.0911  0.0832];
%                 [0.4937  0.5000  0.2625  0.0813  0.2688  0.2750; 0.5000  0.5000  0.0625  0.0813  0.0750  0.0750; 0.4994  0.4994  0.0938  0.0750  0.2622  0.0688; 0.3766  0.3766  0.0081  0.0081  0.0081  0.0080; 0.1326  0.0988  0.0842  0.0781  0.0789  0.0789; 0.2023  0.2023  0.1876  0.1306  0.0928  0.0846];
%                 [0.5000  0.5000  0.4619  0.4682  0.2881  0.4809; 0.5000  0.5000  0.2818  0.0826  0.4619  0.2754; 0.3980  0.3979  0.0127  0.0127  0.0127  0.2053; 0.0127  0.0127  0.0059  0.0059  0.0059  0.0059; 0.1226  0.0968  0.0818  0.0781  0.0774  0.0774; 0.1878  0.1878  0.1645  0.1182  0.0940  0.0831];
%                 [0.4817  0.4695  0.4878  0.4756  0.4817  0.4634; 0.4756  0.4756  0.4634  0.4695  0.4695  0.4756; 0.0146  0.0183  0.0122  0.0122  0.0122  0.0122; 0.0122  0.0122  0.0057  0.0057  0.0057  0.0057; 0.1193  0.0984  0.0872  0.0782  0.0739  0.0739; 0.1526  0.1526  0.1652  0.1229  0.0954  0.0818];
%                 [0.5000  0.4875  0.0815  0.0815  0.0877  0.0815; 0.5000  0.5000  0.0689  0.0815  0.0815  0.0940; 0.1003  0.0896  0.0376  0.0439  0.0376  0.0501; 0.0125  0.0125  0.0056  0.0056  0.0056  0.0056; 0.1158  0.0925  0.0795  0.0765  0.0762  0.0762; 0.1743  0.1743  0.1561  0.1126  0.0867  0.0819]
% };
            
columns = 'C';
rows = 'Sigma';
columns_vals = [0.1000  0.5000  3.0000 10.0000  100.0000    1000.0000];
rows_vals = [0.1000  0.5000  3.0000 10.0000 100.0000 1000.0000];

%% Compute mean errors
nRows = length(rows_vals);
nCols = length(columns_vals);

obj_errors = zeros(nRows, nCols);
noobj_errors = zeros(nRows, nCols);
nTests = length(obj_errors_cell);

for i = 1:nRows
    for j = 1:nCols
        for k = 1:nTests
            obj_errors(i,j) = obj_errors(i,j) + obj_errors_cell{k}(i,j);
            noobj_errors(i,j) = noobj_errors(i,j) + noobj_errors_cell{k}(i,j);
        end
    end
end
obj_errors = obj_errors./nTests;
noobj_errors = noobj_errors./nTests;

%% Start ROC computation

% Variable for storing the "Sensitivity" = TPR
sensitivity = zeros(nRows, nCols);
% Variable for storing the "Specificity" = TNR
specificity = zeros(nRows, nCols);

%% Start computation of specificity and sensitivity
for i = 1:nRows
    for j = 1:nCols
        FN = obj_errors(i,j);
        TP = 1-FN;
        FP = noobj_errors(i,j);
        TN = 1-FP;
        sensitivity(i,j) = TP/(TP+FN);
        specificity(i,j) = TN/(FP+TN);
    end
end

%% Plot
colormap jet;
c = colormap; close(gcf);
c = c(round(linspace(1,size(c,1),nRows)), :);

f = figure; hold on;
leg = {};
for i = 1:nRows
    plot(1-specificity(i,:), sensitivity(i,:), 'Color', colormap(c(i,:)), 'LineWidth', 2, 'Marker', '+');
    for j = 1:nCols
        text(1-specificity(i,j)+0.005, sensitivity(i,j)+0.005, num2str(columns_vals(j)), 'Color', colormap(c(i,:)));
    end
    leg{i} = ['Sigma ' num2str(rows_vals(i))];
end
legend(leg, 4);
xlabel('1 - Specificity');
ylabel('Sensitivity');

saveas(f, 'roc_curve.jpg');

disp('Done');